<!DOCTYPE html><html lang="el"><head><meta charset="UTF-8"/><meta http-equiv="X-UA-Compatible" content="ie=edge"/><meta http-equiv="X-Frame-Options" content="DENY"/><meta http-equiv="X-XSS-Protection" content="1; mode=block"/><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/><meta name="keywords" content="[&quot;Προϊόν&quot;,&quot;P2P&quot;,&quot;οδηγός&quot;,&quot;προγραμματισμός&quot;,&quot;javascript&quot;,&quot;bitcoin&quot;]"/><meta name="description" content="Aaaaah Bitcoin — αυτή η υπέροχη μορφή χρήματος που ανθίζει χάρη στα βασικά της χαρακτηριστικά.  "/><meta property="og:locale" content="el"/><meta property="og:site_name"/><meta property="og:title" content="Peach Bitcoin Exchange - Buy and Sell Bitcoin Anonymously and Without KYC"/><meta property="og:description" content="Peach Bitcoin - Buy Bitcoin with gift card, no verification. Exchange peer to peer for anonymous transactions. Learn how to buy and sell Bitcoin privately and without KYC. Manage your Bitcoin securely with our non-KYC platform."/><meta property="og:type" content="website"/><meta property="og:image" content="/img/blog/under-the-hood/peachmechanic2.png"/><meta property="og:image:secure_url" content="/img/blog/under-the-hood/peachmechanic2.png"/><meta property="og:image:width" content="1296"/><meta property="og:image:height" content="678"/><meta name="twitter:site" content="@peachbitcoin"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Peach Bitcoin κάτω από την κουκούλα: μια τεχνική ματιά στο γιατί είναι το ασφαλέστερο P2P exchange · Peach Bitcoin"/><meta name="twitter:description" content="Peach Bitcoin - Buy Bitcoin with gift card, no verification. Exchange peer to peer for anonymous transactions. Learn how to buy and sell Bitcoin privately and  without KYC. Manage your Bitcoin securely with our non-KYC platform."/><meta name="twitter:image" content="/img/blog/under-the-hood/peachmechanic2.png"/><meta name="msapplication-TileColor" content="#F56522"/><meta name="theme-color" content="#F56522"/><link rel="preload" as="font" crossorigin="crossorigin" href="/fonts/baloo-2-v16-latin-regular.woff2"/><link rel="preload" as="font" crossorigin="crossorigin" href="/fonts/baloo-2-v16-latin-600.woff2"/><link rel="preload" as="font" crossorigin="crossorigin" href="/fonts/baloo-2-v16-latin-800.woff2"/><link rel="apple-touch-icon" href="/img/favicon/apple-touch-icon.png"/><link rel="icon" href="/img/favicon/favicon.svg"/><link rel="manifest" href="/site.webmanifest"/><link rel="mask-icon" href="/img/favicon/safari-pinned-tab.svg" color="#F56522"/><link rel="stylesheet" href="/css/main-8c7d0a0965d37fafcf6e9215d363177f.css"/><title>Peach Bitcoin κάτω από την κουκούλα: μια τεχνική ματιά στο γιατί είναι το ασφαλέστερο P2P exchange · Peach Bitcoin</title><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KQHJRQKH');</script></head><body id="blog-peach-under-the-hood"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KQHJRQKH" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><header class="header header-container" id="header"><div class="wrap"><a class="logo-link brand" href="/el/"><img class="logo logo" src="/img/peach-bitcoin-145cd6c0079ccacc9c70c892060964d1.svg" alt="Peach Bitcoin"/></a><input id="show-menu" type="checkbox"/><label class="nav-toggle-label" id="nav-toggle" for="show-menu"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path class="line--1" d="M0 70l28-28c2-2 2-2 7-2h64"></path><path class="line--2" d="M0 50h99"></path><path class="line--3" d="M0 30l28 28c2 2 2 2 7 2h64"></path></svg></label><nav class="nav"><a href="/el/how-it-works/">Αγοράστε BTC χωρίς KYC</a><a href="/el/for-meetups/">Αγοράστε BTC με μετρητά</a><a href="/el/for-businesses/">Πωλήστε BTC</a><a href="/el/blog/">Ιστολόγιο</a><a href="/el/support/">Υποστήριξη</a><div class="language-selector"><input class="checkbox" type="checkbox" id="language-toggle"/><label class="language-label" for="language-toggle"><img class="flag-icon" src="/img/en-872bf10f0d1ed191b502494534bb329a.png" alt="UK Flag"/><img src="/img/dropdown_icon-fcd9aa7055472ef4a4e83b593450c048.svg" style="width: 1rem;" alt="Dropdown icon"/></label><ul class="language-dropdown"><li><a href="/"><img class="flag-icon" src="/img/en-872bf10f0d1ed191b502494534bb329a.png" alt="EN Flag"/><span>English</span></a></li><li><a href="/es"><img class="flag-icon" src="/img/es-b17fc8846b93c5446b10cd7824434504.png" alt="ES Flag"/><span>Español</span></a></li><li><a href="/de"><img class="flag-icon" src="/img/de-0da84d0f3850d6e25088debeb3ade32c.png" alt="DE Flag"/><span>Deutsch</span></a></li><li><a href="/it"><img class="flag-icon" src="/img/it-299996a0097e49e1bc4f312e380d3faa.png" alt="IT Flag"/><span>Italiano</span></a></li><li><a href="/fr"><img class="flag-icon" src="/img/fr-75a63faa5728ac4175214da6cd3c47f1.png" alt="FR Flag"/><span>Français</span></a></li><li><a href="/el"><img class="flag-icon" src="/img/el-27d234921e954ed945c93bef880a07b6.png" alt="GR Flag"/><span>Ελληνικά</span></a></li><li><a href="/hu"><img class="flag-icon" src="/img/hu-fc4c517f481932d60d59b56a8f0c322d.png" alt="HU Flag"/><span>Magyar</span></a></li><li><a href="/nl"><img class="flag-icon" src="/img/nl-83a65573b2d26cdce16cab98f8c38db1.png" alt="NL Flag"/><span>Nederlands</span></a></li><li><a href="/pl"><img class="flag-icon" src="/img/pl-f7c03eb5351f5b2e33c9b29f1e200e38.png" alt="PL Flag"/><span>Polski</span></a></li><li><a href="/pt"><img class="flag-icon" src="/img/pt-997fb3879120a45e1ba507a9e060a662.png" alt="PT Flag"/><span>Português</span></a></li><li><a href="/sw"><img class="flag-icon" src="/img/sw-cdf6e2b06778f5ac662fb25f3ca8eac0.png" alt="SW Flag"/><span>Kiswahili</span></a></li><li><a href="/uk"><img class="flag-icon" src="/img/ua-f7a81ef67d0931a29f7e358bb99ef521.png" alt="UA Flag"/><span>Українська</span></a></li></ul></div></nav></div></header><main class="main" id="main"><div id="header-anchor"></div><section class="wrap"><div class="content-wrap post"><h1 id="peach-bitcoin-p2p-exchange">Peach Bitcoin κάτω από την κουκούλα: μια τεχνική ματιά στο γιατί είναι το ασφαλέστερο P2P exchange</h1>
<div class="video-wrapper">
  <iframe
    src="https://www.youtube.com/embed/UvdbHlsPmK0"
    title="PEACH VIDEO OF Under the Hood"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
    referrerpolicy="strict-origin-when-cross-origin"
    allowfullscreen
  ></iframe>
</div>
<p>Aaaaah Bitcoin — αυτή η υπέροχη μορφή χρήματος που ανθίζει χάρη στα βασικά της χαρακτηριστικά.<br>
Όλοι το αγαπάμε, αλλά γνωρίζουμε επίσης ότι υπάρχουν κίνδυνοι με την αυτοκυριαρχία: αν μοιραστείς τα seed σου, τα χάνεις όλα.<br>
Αν στείλεις σε λάθος διεύθυνση, δεν θα τα ξαναδείς ποτέ.</p>
<p>Γι’ αυτό είναι σημαντικό το open-source λογισμικό στο οικοσύστημα Bitcoin — η εφαρμογή Peach είναι διαθέσιμη στο Github για όποιον θέλει να την ελέγξει!</p>
<p>Φυσικά, το ότι είναι open-source δεν σημαίνει ότι όλοι θα διαβάσουν προσεκτικά τον κώδικα ή θα καταλάβουν πώς λειτουργεί.<br>
Γι’ αυτό γράφω αυτό το άρθρο: για να <strong>δείξω πόσο ασφαλής είναι η Peach</strong> και ποια βήματα εξασφαλίζουν αυτήν την ασφάλεια.</p>
<h2 id="1-kyc-peach">Βήμα 1: Δημιουργία λογαριασμού χωρίς KYC στην Peach</h2>
<p>Για να είμαστε σαφείς: το Bitcoin seed σου <strong>είναι ο λογαριασμός Peach σου</strong>.</p>
<p>Για να χρησιμοποιήσεις την Peach, πρέπει να δημιουργήσεις έναν λογαριασμό, που περιλαμβάνει την κοινοποίηση του δημόσιου κλειδιού σου και την απόδειξη ότι το κατέχεις.</p>
<p>Για να το κάνεις:</p>
<ul>
<li>1 - πάρε την τρέχουσα ημερομηνία και ώρα (σε milliseconds) ως κείμενο</li>
<li>2 - χρησιμοποίησε το ιδιωτικό κλειδί σου για να υπογράψεις αυτό το κείμενο</li>
<li>3 - υποβάλεις το δημόσιο κλειδί, την τρέχουσα ημερομηνία/ώρα και την υπογραφή</li>
</ul>
<p>Επιπλέον, πρέπει να δημιουργήσεις ένα <code>uniqueId</code> για να αποτρέψεις άλλους χρήστες από το να προσποιηθούν ότι είσαι εσύ.<br>
Αυτό είναι χρήσιμο σε περιπτώσεις όπως η απώλεια των seed αλλά η διατήρηση του ίδιου λογαριασμού.<br>
Αλλά ας μην εμβαθύνουμε τώρα σε αυτό.</p>
<p><br><br>
<img src="/img/blog/under-the-hood/underthehood01.png" alt="this is the power of p2p exchanger" style="display:block; margin: auto; width: 70%;">
<br><br></p>
<p>Αυτός είναι ο κώδικας σε JavaScript:</p>
<pre><code class="language-j">
  const seed = randomBytes(64);

  const root = bip32.fromSeed(seed, bitcoin);
  const child = root.derivePath(&quot;m/0&quot;);
  const keyPair = ECPair.fromPrivateKey(child.privateKey, { network: bitcoin });

  const publicKeyHex = Buffer.from(keyPair.publicKey).toString(&quot;hex&quot;);

  const session = axios.create({
    baseURL: &quot;https://api.peachbitcoin.com/&quot;,
    httpAgent: new http.Agent({ keepAlive: false }),
    httpsAgent: new https.Agent({ keepAlive: false }),
  });

  const registerMessage = String(Date.now());
  const registerMessageSignature = signWithBtcPrivKey(registerMessage, keyPair);

  const resp = await session.post(&quot;v1/user/register&quot;, {
    publicKey: publicKeyHex,
    message: registerMessage,
    signature: registerMessageSignature,
    uniqueId: &quot;my_own_unique_id_random_12345&quot;,
  });

  const accessToken = resp.data.accessToken;

  session.defaults.headers.common[&quot;authorization&quot;] = accessToken;

</code></pre>
<p>Συγχαρητήρια! Μόλις δημιούργησες λογαριασμό στην Peach!<br>
Ο διακομιστής έχει επαληθεύσει ότι εσύ, αυτή τη στιγμή, είσαι ο ιδιοκτήτης του ζεύγους κλειδιών Bitcoin που αντιστοιχεί στο υποβληθέν δημόσιο κλειδί.</p>
<h2 id="2-pgp">Βήμα 2: Υποβολή του Δημόσιου Κλειδιού PGP</h2>
<p>Θα υπάρχει πολλή κρυπτογράφηση… αλλά και κάποια αποκρυπτογράφηση.<br>
Τα Bitcoin κλειδιά επιτρέπουν μόνο μονοκατευθυντική κρυπτογράφηση, οπότε θα χρειαστούμε PGP κλειδιά για αμφίδρομη κρυπτογράφηση.<br>
Αυτό είναι βασικό για την κρυπτογράφηση/αποκρυπτογράφηση τραπεζικών δεδομένων, μηνυμάτων chat κλπ.</p>
<p>Η υποβολή του Δημόσιου Κλειδιού PGP είναι παρόμοια με την υποβολή του Δημόσιου Κλειδιού Bitcoin, αλλά υπάρχει ένα επιπλέον βήμα:<br>
το Δημόσιο Κλειδί PGP πρέπει να υπογραφεί με το Ιδιωτικό Κλειδί Bitcoin για να επαληθευτεί ότι ο χρήστης κατέχει και τα δύο κλειδιά.</p>
<p><br><br>
<img src="/img/blog/under-the-hood/underthehood02.png" alt="this is the power of p2p exchanger" style="display:block; margin: auto; width: 70%;">
<br><br></p>
<pre><code class="language-j">
const { privateKey: pgpPrivateKey, publicKey: pgpPublicKey } =
    await createPGPKey();

  const pgpPublicKeyMessageSignature = signWithBtcPrivKey(
    pgpPublicKey,
    keyPair
  );
  const setPgpKeysMessage = String(Date.now());

  const setPgpKeysMessageSignature = await signPGPMessage(
    pgpPrivateKey,
    setPgpKeysMessage
  );

  await session.patch(&quot;v1/user&quot;, {
    pgpPublicKey: pgpPublicKey, // the PGP Pub key
    signature: pgpPublicKeyMessageSignature, // the above signed by the BTC Key
    message: setPgpKeysMessage, // the current timestamp
    pgpSignature: setPgpKeysMessageSignature, // the above signed by the PGP Key
  });

</code></pre>
<p>Αυτό το σημείο, η Peach έχει και τα δύο Δημόσια Κλειδιά σου — Bitcoin και PGP!<br>
Αυτό θα είναι εξαιρετικά σημαντικό για το trading στην Peach.</p>
<h2 id="">Επόμενα Βήματα</h2>
<p>Από εδώ και πέρα, ο οδηγός θα δείξει και τις δύο πλευρές: τον Αγοραστή και τον Πωλητή.</p>
<p>Τα βήματα είναι:</p>
<ul>
<li>3.S Ο Πωλητής δημιουργεί μια Προσφορά Πώλησης</li>
<li>4.S Ο Πωλητής χρηματοδοτεί το Peach Escrow</li>
<li>5.B Ο Αγοραστής υποβάλλει Αίτημα Συναλλαγής στην Προσφορά</li>
<li>5.S Ο Πωλητής αποδέχεται το Αίτημα Συναλλαγής του Αγοραστή</li>
<li>6.B Ο Αγοραστής δηλώνει ότι η Fiat μεταφορά ολοκληρώθηκε</li>
<li>6.S Ο Πωλητής επιβεβαιώνει ότι έλαβε την Πληρωμή</li>
</ul>
<h2 id="3s">Βήμα 3.S: Ο Πωλητής δημιουργεί Προσφορά Πώλησης</h2>
<p>Η δημιουργία μιας Προσφοράς Πώλησης σημαίνει ότι ο Πωλητής ανακοινώνει ότι είναι πρόθυμος να πουλήσει μια συγκεκριμένη ποσότητα Bitcoin.<br>
Αλλά δεν είναι μόνο αυτό: ο Πωλητής πρέπει να αποδεχτεί κάτι ως αντάλλαγμα.</p>
<p>Μια Προσφορά Πώλησης περιλαμβάνει:</p>
<ul>
<li>ποσότητα Bitcoin προς πώληση</li>
<li>τα νομίσματα που αποδέχεται ο Πωλητής</li>
<li>τους τρόπους πληρωμής που αποδέχεται (μετρητά, τραπεζικό έμβασμα, Revolut κλπ.)</li>
<li>το Premium (πόσο πιο ακριβό είναι το Bitcoin σε σχέση με την τρέχουσα αγορά)</li>
</ul>
<p>Αν όλα πάνε καλά, ένας Αγοραστής θα ενδιαφερθεί και θα ζητήσει να πραγματοποιήσει συναλλαγή.<br>
Σε εκείνο το σημείο, θα πρέπει να επιλέξει <strong>ένα νόμισμα και έναν τρόπο πληρωμής</strong> από τα διαθέσιμα.<br>
Όσο περισσότερες επιλογές εμφανίζει ο Πωλητής, τόσο μεγαλύτερες οι πιθανότητες να προσελκύσει Αγοραστή.</p>
<p><br><br>
<img src="/img/blog/under-the-hood/underthehood03.png" alt="this is the power of p2p exchanger" style="display:block; margin: auto; width: 40%;">
<br><br></p>
<pre><code class="language-j">
const sats_to_sell = 21000;
  const sell_premium = 1; // 1%
  const payment_data_currency = &quot;EUR&quot;;
  const payment_data_method = &quot;wise&quot;;

  const { address: returnAddress } = bitcoin.payments.p2wpkh({
    pubkey: Buffer.from(keyPair.publicKey),
    network: bitcoin,
  });
  const sellOfferPaymentDataToEncrypt = JSON.stringify({
    reference: &quot;&quot;,
    userName: &quot;@myWiseIdTradingBot&quot;,
  });

  const paymentDataEncryptSHA256 = await sha256(sellOfferPaymentDataToEncrypt);

  const offerCreateRes = await session.post(&quot;v1/offer&quot;, {
    type: &quot;ask&quot;,
    amount: sats_to_sell,
    meansOfPayment: { [payment_data_currency]: [payment_data_method] }, // {&quot;EUR&quot;: [&quot;wise&quot;]}
    paymentData: {
      [payment_data_method]: { hashes: [paymentDataEncryptSHA256] },
    },
    returnAddress: returnAddress,
    premium: sell_premium,
  });

</code></pre>
<p>Στον κώδικα, ο Πωλητής ανακοινώνει την πώληση 21.000 sats (0,00021 Bitcoin) με 1% premium.<br>
Θέλει να λάβει Ευρώ μέσω Wise.<br>
Δεν υποβάλλει το Wise ID του, μόνο ένα hash.<br>
Η Peach δεν θα γνωρίζει ποτέ τα στοιχεία πληρωμής του, για να παραμείνει ανώνυμος.<br>
Υποβάλλεται επίσης μια <strong>Διεύθυνση Επιστροφής</strong> για επιστροφές.</p>
<h2 id="4s-peach-escrow">Βήμα 4.S: Ο Πωλητής χρηματοδοτεί το Peach Escrow</h2>
<p>Μετά από επιτυχημένο αίτημα στο API της Peach για τη δημιουργία της Προσφοράς, ο Πωλητής λαμβάνει το ID της Προσφοράς:</p>
<pre><code class="language-j">const sellOfferId = offerCreateRes.data.id;

</code></pre>
<p>Αυτό το ID είναι σημαντικό — κράτησέ το.<br>
Η Προσφορά δημιουργήθηκε αλλά δεν είναι ακόμα δημόσια: κανένας Αγοραστής δεν μπορεί να αλληλεπιδράσει.<br>
Πρώτα, ο Πωλητής πρέπει να χρηματοδοτήσει το Escrow.</p>
<p>Το Escrow είναι σαν ένα θησαυροφυλάκιο που απαιτεί εξουσιοδότηση τόσο από τον Πωλητή όσο και από την Peach.<br>
Το Bitcoin τοποθετείται εκεί και παραμένει ασφαλές μέχρι το τέλος της Συναλλαγής.<br>
Αφού απαιτείται η εξουσιοδότηση του Πωλητή και το Escrow είναι ένα Bitcoin Script (διεύθυνση P2WSH), η Peach χρειάζεται το Δημόσιο Κλειδί του Πωλητή για να δημιουργήσει το Escrow.</p>
<p>Σε αυτό το σημείο, ο Πωλητής υποβάλλει το Δημόσιο Κλειδί που θα χρησιμοποιηθεί.<br>
Η Peach επιλέγει το δικό της Δημόσιο Κλειδί και κατασκευάζει τη διεύθυνση.</p>
<p><br><br>
<img src="/img/blog/under-the-hood/underthehood04.png" alt="this is the power of p2p exchanger" style="display:block; margin: auto; width: 40%;">
<br><br></p>
<pre><code class="language-j">const childSell = root.derivePath(`m/84'/0'/0'/${sellOfferId}'`);

  const keyPairSellOffer = ECPair.fromPrivateKey(childSell.privateKey, {
    network: bitcoin,
  });

  const sellOfferPublicKey = Buffer.from(keyPairSellOffer.publicKey).toString(
    &quot;hex&quot;
  );

  const escrowCreateRes = await session.post(
    &quot;v1/offer/&quot; + sellOfferId + &quot;/escrow&quot;,
    {
      publicKey: sellOfferPublicKey,
    }
  );

  const escrowAddress = escrowCreateRes.data.escrows.bitcoin;

  const escrowPeachPublicKey =
    escrowCreateRes.data.escrowPeachPublicKey.bitcoin;

</code></pre>
<p>Στον κώδικα, ο Πωλητής παράγει ένα νέο ζεύγος κλειδιών από το ID της Προσφοράς.<br>
Αυτό είναι ασφαλές και αναπαραγώγιμο.</p>
<p>Μετά την υποβολή του Δημόσιου Κλειδιού, το API επιστρέφει τη διεύθυνση όπου πρέπει να στείλει τα 21.000 sats.<br>
Αλλά δεν χρειάζεται να εμπιστευτείς τυφλά — μπορείς να το επαληθεύσεις.</p>
<p>Ας το επαληθεύσουμε!</p>
<p>Το API επιστρέφει επίσης το Δημόσιο Κλειδί που χρησιμοποίησε η Peach για αυτό το Escrow, ώστε να μπορούμε να <strong>αναδημιουργήσουμε τη διεύθυνση</strong> με το Bitcoin Script.</p>
<pre><code class="language-j">   OP_IF
       ${script.number.encode(4320).toString(&quot;hex&quot;)}
       OP_CHECKSEQUENCEVERIFY
       OP_DROP
   OP_ELSE
       ${sellerPublicKey}
       OP_CHECKSIGVERIFY
   OP_ENDIF
   ${peachPublicKey}
   OP_CHECKSIG
</code></pre>
<p>Το Script για το Escrow:</p>
<ul>
<li>απαιτεί πάντα την υπογραφή της Peach</li>
<li>και επιπλέον:
<ul>
<li>απαιτεί την υπογραφή του Πωλητή</li>
<li>ή ότι έχουν εξορυχθεί 4320 blocks από την αποστολή του Bitcoin</li>
</ul>
</li>
</ul>
<p>Γιατί 4320 blocks;<br>
Αυτό ισοδυναμεί με περίπου 30 μέρες blocks (1 block κάθε 10 λεπτά).<br>
Μετά από 30 μέρες, η Peach μπορεί να υπογράψει μόνη της σε περίπτωση που ο Πωλητής δεν συνεργαστεί ή χάσει τα κλειδιά.</p>
<p>Η Peach έχει άριστη φήμη στη διαχείριση των κεφαλαίων των Πωλητών.</p>
<p>Μετά την κατασκευή του script, μπορείς να επαληθεύσεις ότι η παραγόμενη διεύθυνση P2WSH ταιριάζει με αυτή που έστειλε το API.</p>
<pre><code class="language-j">  const multisigScript = bitcoin.script.compile([
    Buffer.from(sellOfferPublicKey, &quot;hex&quot;),
    bitcoin.opcodes.OP_CHECKSIGVERIFY,
  ]);

  const timelockScript = bitcoin.script.compile([
    bitcoin.script.number.encode(4320),
    bitcoin.opcodes.OP_CHECKSEQUENCEVERIFY,
    bitcoin.opcodes.OP_DROP,
  ]);

  const redeemScript = bitcoin.script.compile([
    bitcoin.opcodes.OP_IF,
    ...timelockScript,
    bitcoin.opcodes.OP_ELSE,
    ...multisigScript,
    bitcoin.opcodes.OP_ENDIF,
    Buffer.from(escrowPeachPublicKey, &quot;hex&quot;),
    bitcoin.opcodes.OP_CHECKSIG,
  ]);

  const escrowPayment = bitcoin.payments.p2wsh({
    redeem: { output: redeemScript },
    network: bitcoin,
  });

  console.log(&quot;Addresses Match:&quot;, escrowPayment.address === escrowAddress);

</code></pre>
<p>Τέλεια! Τώρα απλώς στείλε μια συναλλαγή Bitcoin σε αυτή τη διεύθυνση και περίμενε να δηλωθεί ότι το Escrow έχει χρηματοδοτηθεί.</p>
<pre><code class="language-j">  while (true) {
    const fundingStatusRes = await session.get(
      &quot;v1/offer/&quot; + sellOfferId + &quot;/escrow&quot;
    );
    if (fundingStatusRes.data.funding.status === &quot;FUNDED&quot;) {
      break;
    }
  }

</code></pre>
<p>Μετά από ένα block, η Προσφορά γίνεται δημόσια και οι Αγοραστές μπορούν να αλληλεπιδράσουν.</p>
<h2 id="5b">Βήμα 5.B: Ο Αγοραστής υποβάλλει Αίτημα Συναλλαγής στην Προσφορά</h2>
<p>Τώρα είναι η στιγμή για δράση του Αγοραστή!</p>
<p>Πρώτα, ελέγχουμε όλες τις διαθέσιμες Προσφορές Πώλησης:</p>
<pre><code class="language-j">const sellOffers = await session.get(&quot;v069/sellOffer&quot;);
</code></pre>
<p>Για απλότητα, ο Αγοραστής ενδιαφέρεται για την πρώτη διαθέσιμη Προσφορά Πώλησης.</p>
<pre><code class="language-j">const sellOfferToTradeRequestId = sellOffers.data.offers[0].id;
</code></pre>
<p>Ο Αγοραστής θέλει να υποβάλει Αίτημα Συναλλαγής, δηλώνοντας ότι θέλει να κάνει συναλλαγή σύμφωνα με τους όρους του Πωλητή.<br>
Ακούγεται απλό, αλλά αυτό είναι το πιο πολύπλοκο βήμα ολόκληρης της διαδικασίας.</p>
<p>Ας αναλύσουμε τι πρέπει να υποβάλει ο Αγοραστής:</p>
<ul>
<li>Προτιμώμενος τρόπος πληρωμής (ένας από τους επιτρεπόμενους από τον Πωλητή)</li>
<li>Προτιμώμενο νόμισμα (όπως παραπάνω)</li>
<li>Συμμετρικό Κλειδί (για άμεση επικοινωνία με τον Πωλητή) κρυπτογραφημένο</li>
<li>Υπογραφή του Συμμετρικού Κλειδιού</li>
<li>Δεδομένα πληρωμής κρυπτογραφημένα με το Συμμετρικό Κλειδί</li>
<li>Υπογραφή των Δεδομένων Πληρωμής</li>
<li>Διεύθυνση Παραλαβής: πού θέλει να λάβει τα Bitcoin που αγοράζει</li>
<li>Υπογραφή της Διεύθυνσης Παραλαβής (BIP-322) για απόδειξη ιδιοκτησίας</li>
<li>Μέγιστο κόστος mining που είναι διατεθειμένος να πληρώσει</li>
</ul>
<p>Πολύ, σωστά;<br>
Αλλά γι’ αυτό η Peach είναι υπερασφαλής!<br>
Πάμε βήμα-βήμα.</p>
<h3 id="-2">Προτιμώμενος τρόπος πληρωμής και νόμισμα</h3>
<p>Αυτό είναι το πιο απλό:</p>
<pre><code class="language-j">  const payment_data_currency = &quot;EUR&quot;;
  const payment_data_method = &quot;wise&quot;;

</code></pre>
<h3 id="-3">Συμμετρικό Κλειδί</h3>
<p>Το Συμμετρικό Κλειδί θα χρησιμοποιηθεί με <strong>AES256 Διπλής Κατεύθυνσης</strong>: μπορείς να κρυπτογραφήσεις και να αποκρυπτογραφήσεις με το ίδιο κλειδί.</p>
<pre><code class="language-j">async function decryptDataWithSymmetricKey(encryptedMessage, symmetricKey) {
  const message = await openpgp.readMessage({
    armoredMessage: encryptedMessage,
  });

  const { data: decrypted } = await openpgp.decrypt({
    message,
    passwords: [symmetricKey],
    format: &quot;utf8&quot;,
  });

  return decrypted;
}

async function encryptDataWithSymmetricKey(data, symmetricKey) {
  const message = await openpgp.createMessage({ text: data });
  const encrypted = await openpgp.encrypt({
    message,
    passwords: [symmetricKey],
    format: &quot;armored&quot;,
    config: {
      preferredSymmetricAlgorithm: openpgp.enums.symmetric.aes256,
    },
  });
  return encrypted;
}

</code></pre>
<p>Δημιούργησέ το τυχαία:</p>
<pre><code class="language-j">  const symmetricKey = randomBytes(32);
  const symmetricKeyHex = symmetricKey.toString(&quot;hex&quot;);

</code></pre>
<p>Δεν πρέπει να υποβληθεί σε απλό κείμενο!<br>
Πρέπει να κρυπτογραφηθεί έτσι ώστε μόνο ο Αγοραστής και ο Πωλητής να μπορούν να το αποκρυπτογραφήσουν, χρησιμοποιώντας τα Δημόσια Κλειδιά PGP.</p>
<pre><code class="language-j">async function encryptForMultipleRecipients(secret, publicKeysArmored) {
  const publicKeys = await Promise.all(
    publicKeysArmored.map((armored) =&gt; openpgp.readKey({ armoredKey: armored }))
  );
  const message = await openpgp.createMessage({ text: secret });

  const encrypted = await openpgp.encrypt({
    message,
    encryptionKeys: publicKeys,
  });

  return encrypted;
}

  const matchingUserPgpPubKey = sellOffers.data.offers[0].user.pgpPublicKey;

  const symmetricKeyEncrypted = await encryptForMultipleRecipients(
    symmetricKeyHex,
    [pgpPublicKey, matchingUserPgpPubKey]
  );

</code></pre>
<p>Ο Πωλητής πρέπει να υπογράψει επίσης το Συμμετρικό Κλειδί για να επιβεβαιώσει ότι δημιουργήθηκε από τον Αγοραστή:</p>
<pre><code class="language-j">  const symmetricKeySignature = await signPGPMessage(
    pgpPrivateKey,
    symmetricKeyHex
  );

</code></pre>
<h3 id="-4">Δεδομένα Πληρωμής</h3>
<p>Εδώ βρίσκονται τα πιο ευαίσθητα δεδομένα: IBAN, username Revolut κλπ.<br>
Ο Αγοραστής τα κρυπτογραφεί με το Συμμετρικό Κλειδί, ώστε μόνο ο Πωλητής να μπορεί να τα διαβάσει.</p>
<pre><code class="language-j">const paymentDataToEncrypt = JSON.stringify({
    reference: &quot;&quot;,
    userName: &quot;@buyerWiseId&quot;,
  });

const paymentDataEncrypted = await encryptDataWithSymmetricKey(
paymentDataToEncrypt,
symmetricKeyHex
);

const paymentDataSignature = await signPGPMessage(
pgpPrivateKey,
paymentDataToEncrypt
);

</code></pre>
<h3 id="-5">Ορισμός Διεύθυνσης Παραλαβής και απόδειξη ιδιοκτησίας</h3>
<p>Πρέπει να ορίσεις πού θέλεις να σταλούν τα Bitcoin μετά τη Συναλλαγή.<br>
Η δημιουργία διεύθυνσης είναι εύκολη.<br>
Η απόδειξη ιδιοκτησίας είναι πιο δύσκολη και γίνεται για κανονιστικούς λόγους και ασφάλεια.<br>
Χρησιμοποιούμε <strong>BIP-322</strong>: υπογράφεις ένα μήνυμα με το Ιδιωτικό σου Κλειδί Bitcoin, επαληθεύσιμο από τη διεύθυνση.</p>
<pre><code class="language-j">  const { address } = bitcoin.payments.p2wpkh({
    pubkey: Buffer.from(keyPair.publicKey),
    network: bitcoin,
  });

  const ownershipMessage =
    &quot;I confirm that only I, peach&quot; +
    publicKeyHex.slice(0, 8) +
    &quot;, control the address &quot; +
    address;

  const releaseAddressSignature = signWithBIP322(
    wif,
    address,
    ownershipMessage
  );

</code></pre>
<h3 id="mining">Τελευταία λεπτομέρεια: Μέγιστο κόστος mining</h3>
<p>Ο Αγοραστής μπορεί να καθορίσει πόσα είναι διατεθειμένος να πληρώσει σε fees για να λάβει τα Bitcoin.</p>
<h3 id="-6">Τέλος, υποβολή Αιτήματος Συναλλαγής</h3>
<p>Τώρα όλα είναι έτοιμα και ο Αγοραστής στέλνει το Αίτημα Συναλλαγής.</p>
<pre><code class="language-j">  await session.post(
    &quot;v069/sellOffer/&quot; + sellOfferToTradeRequestId + &quot;/tradeRequestPerformed&quot;,
    {
      paymentMethod: payment_data_method,
      currency: payment_data_currency,
      paymentDataHashed: paymentDataToEncryptSHA256,
      paymentDataEncrypted: paymentDataEncrypted,
      paymentDataSignature: paymentDataSignature,
      symmetricKeyEncrypted: symmetricKeyEncrypted,
      symmetricKeySignature: symmetricKeySignature,
      maxMiningFeeRate: 2, // sats/vb
      releaseAddress: address,
      releaseAddressMessageSignature: releaseAddressSignature,
    }
  );

</code></pre>
<p><br><br>
<img src="/img/blog/under-the-hood/underthehood05.png" alt="this is the power of p2p exchanger" style="display:block; margin: auto; width: 40%;">
<br><br></p>
<p>Τώρα είναι η σειρά του Πωλητή να το αποδεχτεί.</p>
<h2 id="5s">Βήμα 5.S: Ο Πωλητής αποδέχεται το Αίτημα Συναλλαγής</h2>
<p>Ο Πωλητής περιμένει Αγοραστή να αλληλεπιδράσει με την Προσφορά του.<br>
Ελέγχει τη λίστα Αιτημάτων Συναλλαγής:</p>
<pre><code class="language-j">const receivedTradeRequestRequest = await session.get(
    &quot;v069/sellOffer/&quot; + sellOfferId + &quot;/tradeRequestReceived&quot;
  );

  const tradeReq = receivedTradeRequestRequest.data[0];

</code></pre>
<p>Αν ο Πωλητής θέλει να αποδεχτεί το Αίτημα, πρέπει να μοιραστεί τα δεδομένα πληρωμής του με τον Αγοραστή, ώστε να ξέρει πού να στείλει τα Fiat.</p>
<p>Εφόσον το Συμμετρικό Κλειδί έχει ήδη δημιουργηθεί από τον Αγοραστή, ο Πωλητής μπορεί να το αποκρυπτογραφήσει και να το χρησιμοποιήσει για να κρυπτογραφήσει τα δικά του δεδομένα πληρωμής.</p>
<pre><code class="language-j">  const receivedSymmetricKey = await decryptWithPrivateKey(
    tradeReq.symmetricKeyEncrypted,
    pgpPrivateKey
  );

  const sellOfferPaymentDataEncrypted = await encryptDataWithSymmetricKey(
    sellOfferPaymentDataToEncrypt,
    receivedSymmetricKey
  );

  const sellOfferPaymentDataSignature = await signPGPMessage(
    pgpPrivateKey,
    sellOfferPaymentDataToEncrypt
  );

</code></pre>
<p>Και αυτό είναι! Τώρα ο Πωλητής μπορεί να αποδεχτεί το Αίτημα και ξεκινά η επίσημη Συναλλαγή.</p>
<p><br><br>
<img src="/img/blog/under-the-hood/underthehood06.png" alt="this is the power of p2p exchanger" style="display:block; margin: auto; width: 40%;">
<br><br></p>
<pre><code class="language-j">  await session.post(
    &quot;v069/sellOffer/&quot; +
      sellOfferId +
      &quot;/tradeRequestReceived/&quot; +
      tradeReq.userId +
      &quot;/accept&quot;,
    {
      paymentDataEncrypted: sellOfferPaymentDataEncrypted,
      paymentDataSignature: sellOfferPaymentDataSignature,
      paymentData: {
        [payment_data_method]: { hashes: [paymentDataEncryptSHA256] },
      },
    }
  );

</code></pre>
<p>Αν η διαδικασία φαίνεται περίπλοκη, εδώ υπάρχει μια εικόνα που την απεικονίζει:</p>
<p><br><br>
<img src="/img/blog/under-the-hood/underthehood07.png" alt="this is the power of p2p exchanger" style="display:block; margin: auto; width: 90%;">
<br><br></p>
<h2 id="6b">Βήμα 6.B: Ο Αγοραστής δηλώνει ότι η Πληρωμή πραγματοποιήθηκε</h2>
<p>Ο Αγοραστής μπορεί να ελέγξει αν έχει συμβόλαια (Trades συμφωνημένα με Πωλητή) μέσω του endpoint <code>contract summaries</code>:</p>
<pre><code class="language-j">  const contractsRes = await session.get(&quot;v1/contracts/summary&quot;);
  const contract = contractsRes.data.find((obj) =&gt;
    obj.id.startsWith(sellOfferToTradeRequestId + &quot;-&quot;)
  );

  if (contract.tradeStatus !== &quot;paymentRequired&quot;) throw Error;
</code></pre>
<p>Αν ένα συμβόλαιο έχει κατάσταση <strong>“paymentRequired”</strong>, τότε πρέπει να προχωρήσει στην Fiat πληρωμή.</p>
<p>Για αυτό, αποκρυπτογραφεί τα δεδομένα πληρωμής του Πωλητή χρησιμοποιώντας το Συμμετρικό Κλειδί από τη στιγμή που δημιουργήθηκε το Αίτημα Συναλλαγής.<br>
Αν δεν το έχει αποθηκεύσει, μπορεί να χρησιμοποιήσει το Ιδιωτικό Κλειδί PGP.</p>
<pre><code class="language-j">
  const contractRes = await session.get(&quot;v1/contract/&quot; + contract.id);

  const receivedSymmetricKey = await decryptWithPrivateKey(
    contractRes.data.symmetricKeyEncrypted,
    pgpPrivateKey
  );

  if (receivedSymmetricKey !== symmetricKeyHex) throw Error;

  const decryptedSellerPaymentData = await decryptDataWithSymmetricKey(
    contractRes.data.paymentDataEncrypted,
    receivedSymmetricKey
  );

  console.log(&quot;Seller Payment Data &quot;, JSON.parse(decryptedSellerPaymentData));
</code></pre>
<p>Αυτό συμβαίνει εκτός Peach: ο Αγοραστής ανοίγει την Τραπεζική του εφαρμογή και στέλνει την Fiat πληρωμή.</p>
<p>Το Bitcoin είναι ήδη στο Escrow, ελεγχόμενο από την Peach και τον Πωλητή.<br>
Μπορείς να ελέγξεις τη διεύθυνση Escrow με έναν Blockchain Explorer.</p>
<p>Μετά την πληρωμή, ο Αγοραστής δηλώνει ότι έγινε η Πληρωμή:</p>
<pre><code class="language-j">  const confirmPaymentRes = await session.post(
    &quot;v1/contract/&quot; + contract.id + &quot;/payment/confirm&quot;
  );
</code></pre>
<p><br><br>
<img src="/img/blog/under-the-hood/underthehood08.png" alt="this is the power of p2p exchanger" style="display:block; margin: auto; width: 40%;">
<br><br></p>
<p>Αυτό ήταν το τελευταίο βήμα του Αγοραστή.<br>
Τώρα ο Πωλητής πρέπει να επιβεβαιώσει ότι έλαβε τα Fiat και να απελευθερώσει τα Bitcoin στον Αγοραστή.</p>
<h2 id="6s">Βήμα 6.S: Ο Πωλητής επιβεβαιώνει την Πληρωμή</h2>
<p>Όπως και ο Αγοραστής, ο Πωλητής ελέγχει τα συμβόλαια που του έχουν ανατεθεί.</p>
<pre><code class="language-j">  const contractsRes = await session.get(&quot;v1/contracts/summary&quot;);
  const contract = contractsRes.data[0];

  const contractRes = await session.get(&quot;v1/contract/&quot; + contract.id);

</code></pre>
<p>Η απάντηση του API περιλαμβάνει μια <strong>PSBT</strong> (Partially Signed Bitcoin Transaction)<br>
που στέλνει τα Bitcoin από το Escrow στη διεύθυνση του Αγοραστή.<br>
Έχει ήδη την υπογραφή της Peach και χρειάζεται μόνο την υπογραφή του Πωλητή.</p>
<pre><code class="language-j">  const releasePSBTBase64 = contractRes.data.releasePsbt;

  const parsedPSBT = bitcoin.Psbt.fromBase64(releasePSBTBase64, {
    network: bitcoin,
  });

  parsedPSBT.signInput(0, childSell);

</code></pre>
<p><br><br>
<img src="/img/blog/under-the-hood/underthehood09.png" alt="this is the power of p2p exchanger" style="display:block; margin: auto; width: 40%;">
<br><br></p>
<p>Τώρα ο Πωλητής ολοκληρώνει τη Συναλλαγή, προσθέτοντας τις 2 υπογραφές και το Escrow Bitcoin Script.<br>
Χρησιμοποιούμε τη MultiSig διαδρομή (δεύτερη διαδρομή του script) και βάζουμε <code>OP_FALSE</code> στο stack για να επηρεάσουμε σωστά την IF δήλωση.</p>
<pre><code class="language-j">export const getFinalScript = (_inputIndex, input, bitcoinScript) =&gt; {
  const network = bitcoin;

  const payment = payments.p2wsh({
    network,
    redeem: {
      network,
      output: bitcoinScript,
      input: bitcoin.script.compile([
        input.partialSig[0].signature,
        input.partialSig[1].signature,
        opcodes.OP_FALSE,
      ]),
    },
  });

  parsedPSBT.finalizeInput(0, getFinalScript);

  const tx = parsedPSBT.extractTransaction().toHex();

</code></pre>
<p>Το τελευταίο βήμα: υποβολή της ολοκληρωμένης Συναλλαγής στο API της Peach:</p>
<pre><code class="language-j">  await session.post(&quot;v1/contract/&quot; + contract.id + &quot;/payment/confirm&quot;, {
    releaseTransaction: tx,
  });

</code></pre>
<p>Κυρίες και κύριοι, έτσι γίνεται το trading στην Peach με <strong>μέγιστη ασφάλεια και ιδιωτικότητα!</strong></p>
<p class="date">October 23rd, 2025</p><p class="tags">Tagged with:<a href="/el/blog/tag/">Προϊόν</a><a href="/el/blog/tag/p2p">P2P</a><a href="/el/blog/tag/">Οδηγός</a></p><p><a href="/el/blog/">All blog posts</a></p></div></section></main><footer class="footer" id="footer"><div class="wrap"><div class="logo-section"><div class="logo"><img class="logo-image" src="/img/peach-footer-logo-e28fd7e07f654f43afd63c9b6ace3cdb.svg" alt="Peach logo"/><span>Made in Switzerland <img src="/img/flags/switzerland-icon.svg" style="width: 1rem; margin-left .5rem;"/></span></div><div class="company-info"> <img class="polyreg-image" src="/img/polyreg-52ec37fb80d0312b219110c05567ad3d.png" alt="Polyreg logo" width="120"/><p>Η Peach είναι μέλος της SRO (Οργάνωση Αυτορρύθμισης) της Polyreg </p><p>Η Peach είναι αδειοδοτημένος πάροχος χρηματοοικονομικών υπηρεσιών στην Ελβετία και συμμορφώνεται πλήρως με τον Ελβετικό Νόμο για την Καταπολέμηση της Νομιμοποίησης Εσόδων από Παράνομες Δραστηριότητες. </p></div></div><div class="content"><div class="footer-box"><h6>Εταιρεία</h6><a href="/el/join-us/">Γίνετε μέλος</a><a href="/el/terms-and-conditions/">Όροι χρήσης</a><a href="/el/privacy-policy/">Πολιτική απορρήτου</a><a class="cookie-link" href="#" onclick="showCookiePopup(event)">Διαχείριση προτιμήσεων cookie</a></div><div class="footer-box"><h6>Επικοινωνία</h6><a href="mailto:hello@peachbitcoin.com">Email</a><a href="https://keys.openpgp.org/vks/v1/by-fingerprint/48339A19645E2E53488E0E5479E1B270FACD1BD2">Κλειδί PGP</a></div><div class="footer-box"><h6>Λήψη</h6><span>0.69.0 (294)</span><a href="/el/apk/">APK</a><a href="https://testflight.apple.com/join/wfSPFEWG">iPhone</a><a href="https://play.google.com/store/apps/details?id=com.peachbitcoin.peach.mainnet">Android</a></div><div class="footer-box"><h6>Κοινότητα</h6><a href="https://twitter.com/peachbitcoin" target="_blank" rel="noreferrer noopener">Twitter</a><a href="https://t.me/peachtopeach" target="_blank" rel="noreferrer noopener">Telegram</a><a href="https://discord.gg/ypeHz3SW54" target="_blank" rel="noreferrer noopener">Discord</a><a href="https://www.instagram.com/peachbitcoin/" target="_blank" rel="noreferrer noopener">Instagram</a><a href="https://snort.social/p/npub15369wu3wzzar5fclhecyqfv683x69n6nhlg7rxqnsg2dydgxflpq3apswl" target="_blank" rel="noreferrer noopener">Nostr</a><a href="https://github.com/Peach2Peach" target="_blank" rel="noreferrer noopener">Github</a><a href="https://www.youtube.com/@peachbitcoin" target="_blank" rel="noreferrer noopener">YouTube</a></div><div class="footer-box"><h6>Bitcoin</h6><a href="/bitcoin.pdf">Λευκό βιβλίο</a><a href="https://docs.peachbitcoin.com">Τεκμηρίωση API</a></div><div class="footer-box"><h6>Κερδίστε Bitcoin</h6><a href="/el/new-users/">Κωδικός αναφοράς</a><a href="/el/for-businesses/">Γίνετε συνεργάτης</a></div></div></div></footer><style>#cookie-banner {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background-color: #120A07;
  color: #fff;
  padding: 15px 0;
  z-index: 9999;
  font-size: 14px;
}
#cookie-banner .cookie-container {
  width: 90%;
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  align-items: center;
}
#cookie-banner p {
  margin: 0;
  line-height: 1.4;
}
#cookie-banner .cookie-actions {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-top: 10px;
}
#cookie-banner button {
  padding: 10px 16px;
  color: #fff;
  background-color: #65A519;
  border: none;
  cursor: pointer;
  border-radius: 4px;
  font-size: 14px;
  transition: background-color 0.3s ease;
}
#cookie-banner button:hover {
  background-color: #65A519;
}
#cookie-banner button.reject {
  background-color: #DF321F;
}
#cookie-banner button.reject:hover {
  background-color: #DF321F;
}
#cookie-banner a.cookie-link {
  color: #fff;
  text-decoration: underline;
  font-size: 14px;
  margin-left: 8px;
  cursor: pointer;
}
#cookie-banner a.cookie-link:hover {
  text-decoration: none;
}
/* Popup overlay */
#cookie-popup {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.8);
  z-index: 10000;
  justify-content: center;
  align-items: center;
  color: #fff;
}
/* Contenitore del popup */
#cookie-popup-content {
  position: relative;
  background-color: #120A07;
  color:rgb(255, 255, 255);
  padding: 30px 20px 20px;
  border-radius: 10px;
  width: 80%;
  max-width: 600px;
  box-sizing: border-box;
}
/* Pulsante di chiusura */
#cookie-popup-content .close-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  background: none;
  border: none;
  color: #fff;
  font-size: 24px;
  line-height: 1;
  cursor: pointer;
  padding: 0 5px;
}
#cookie-popup-content .close-btn:hover {
  color: #ccc;
}
/* Stile per ciascuna categoria di cookie */
.cookie-category {
  margin-bottom: 20px;
}
/* Migliora i checkbox e le label */
.cookie-category label {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  font-size: 15px;
}
.cookie-category input[type="checkbox"] {
  accent-color: #4CAF50;
  margin: 0;
  cursor: pointer;
}
.cookie-category p {
  margin: 4px 0 0 28px;
  font-size: 14px;
  line-height: 1.4;
  color: #ccc;
}
/* Bottone "Salva Preferenze" */
#cookie-popup-content button.save-btn {
  background-color: #4CAF50;
  border: none;
  padding: 10px 16px;
  color: #fff;
  font-size: 14px;
  cursor: pointer;
  border-radius: 4px;
  transition: background-color 0.3s ease;
}
#cookie-popup-content button.save-btn:hover {
  background-color: #43a047;
}
/* Media query per schermi più piccoli */
@media (max-width: 768px) {
  #cookie-banner .cookie-container {
    flex-direction: column;
    align-items: flex-start;
  }
  #cookie-banner .cookie-actions {
    margin-top: 10px;
    width: 100%;
    justify-content: flex-start;
    gap: 8px;
    flex-wrap: wrap;
  }
}

</style><div id="cookie-banner" style="display: none;"><div class="cookie-container"><p>Χρησιμοποιούμε cookies για να βελτιώσουμε την εμπειρία σας. <a href="/privacy-policy" style="color: #4CAF50;">Μάθετε περισσότερα</a></p><div class="cookie-actions"><button class="cookie-btn" onclick="acceptCookies()">Αποδοχή Cookies &amp; Συνέχεια</button><button class="cookie-btn reject" onclick="rejectCookies()">Απόρριψη Cookies</button><a class="cookie-link" href="#" onclick="showCookiePopup(event)">Διαχείριση Cookies</a></div></div></div><div id="cookie-popup"><div id="cookie-popup-content"><button class="close-btn" type="button" onclick="closeCookiePopup()">×</button><h2>Διαχείριση προτιμήσεων cookie</h2><div class="cookie-category"><div class="switch-container"><span class="label-text">Απαραίτητα Cookies</span><label class="switch" for="necessary-cookies"><input type="checkbox" id="necessary-cookies" checked="checked" disabled="disabled"/><span class="slider"></span></label></div><p>Αυτά τα cookies είναι απαραίτητα για τη λειτουργία του ιστότοπου.</p></div><div class="cookie-category"><div class="switch-container"><span class="label-text">Cookies Ανάλυσης</span><label class="switch" for="analytics-cookies"><input type="checkbox" id="analytics-cookies"/><span class="slider"></span></label></div><p>Τα cookies ανάλυσης μας βοηθούν να κατανοήσουμε πώς οι χρήστες αλληλεπιδρούν με τον ιστότοπο.</p></div><div class="cookie-category"><div class="switch-container"><span class="label-text">Cookies Marketing</span><label class="switch" for="marketing-cookies"><input type="checkbox" id="marketing-cookies"/><span class="slider"></span></label></div><p>Τα cookies marketing χρησιμοποιούνται για τη συλλογή πληροφοριών χρηστών</p></div><div style="text-align: right; margin-top: 20px;"><button class="save-btn" type="button" onclick="savePreferences()">Αποθήκευση Προτιμήσεων</button></div></div></div><script src="/js/main-15c0432b5e5f06cbab9e3fedcaae3032.js"></script><script>if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/service-worker.js')
      .then(function(registration) {
        console.log('Service Worker registrato con successo:', registration);
      })
      .catch(function(error) {
        console.log('Registrazione del Service Worker fallita:', error);
      });
  });
} else {
  console.log('Service Worker non supportato in questo browser.');
}</script><script>window.onload = function() {
  setTimeout(function() {
    const languageLabel = document.querySelector('.language-label img');

    const languageMap = {
      'en': { text: 'English', flag: '/img/en-872bf10f0d1ed191b502494534bb329a.png' },
      'es': { text: 'Español', flag: '/img/es-b17fc8846b93c5446b10cd7824434504.png' },
      'de': { text: 'Deutsch', flag: '/img/de-0da84d0f3850d6e25088debeb3ade32c.png' },
      'it': { text: 'Italiano', flag: '/img/it-299996a0097e49e1bc4f312e380d3faa.png' },
      'fr': { text: 'Français', flag: '/img/fr-75a63faa5728ac4175214da6cd3c47f1.png' },
      'el': { text: 'Ελληνικά', flag: '/img/el-27d234921e954ed945c93bef880a07b6.png' },
      'hu': { text: 'Magyar', flag: '/img/hu-fc4c517f481932d60d59b56a8f0c322d.png' },
      'nl': { text: 'Nederlands', flag: '/img/nl-83a65573b2d26cdce16cab98f8c38db1.png' },
      'pl': { text: 'Polski', flag: '/img/pl-f7c03eb5351f5b2e33c9b29f1e200e38.png' },
      'pt': { text: 'Português', flag: '/img/pt-997fb3879120a45e1ba507a9e060a662.png' },
      'sw': { text: 'Kiswahili', flag: '/img/sw-cdf6e2b06778f5ac662fb25f3ca8eac0.png' },
      'uk': { text: 'Українська', flag: '/img/ua-f7a81ef67d0931a29f7e358bb99ef521.png' }
    };

    const currentPath = window.location.pathname;
    let currentLang = 'en';

    // Determinare la lingua corrente dal percorso
    for (const lang in languageMap) {
      if (currentPath.includes('/' + lang)) {
        currentLang = lang;
        break;
      }
    }

    // Aggiorna la bandiera e il testo dinamicamente
    if (languageLabel && languageMap[currentLang]) {
      languageLabel.src = languageMap[currentLang].flag;
    }
  }); // Ritardo per garantire che la pagina sia completamente caricata
};
</script><script>window.__ow = window.__ow || {};
window.__ow.organizationId = "8b099b27-4836-4896-9087-a7ed505dec79";
window.__ow.template_id = "b97be07a-7dcf-48af-8d69-a9dfae5dfc29";
window.__ow.integration_name = "manual_settings";
window.__ow.product_name = "chatbot";   
;(function(n,t,c){function i(n){return e._h?e._h.apply(null,n):e._q.push(n)}var e={_q:[],_h:null,_v:"2.0",on:function(){i(["on",c.call(arguments)])},once:function(){i(["once",c.call(arguments)])},off:function(){i(["off",c.call(arguments)])},get:function(){if(!e._h)throw new Error("[OpenWidget] You can't use getters before load.");return i(["get",c.call(arguments)])},call:function(){i(["call",c.call(arguments)])},init:function(){var n=t.createElement("script");n.async=!0,n.type="text/javascript",n.src="https://cdn.openwidget.com/openwidget.js",t.head.appendChild(n)}};!n.__ow.asyncInit&&e.init(),n.OpenWidget=n.OpenWidget||e}(window,document,[].slice))</script><noscript>You need to <a href="https://www.chatbot.com/help/chat-widget/enable-javascript-in-your-browser/" rel="noopener nofollow">enable JavaScript</a> in order to use the AI chatbot tool powered by <a href="https://www.chatbot.com/" rel="noopener nofollow" target="_blank">ChatBot</a></noscript><script>(function() {
  // Funzioni di utilità per gestire i cookie
  function setCookie(name, value, days) {
    var expires = "";
    if (days) {
      var date = new Date();
      date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
      expires = "; expires=" + date.toUTCString();
    }
    document.cookie = name + "=" + (value || "") + expires + "; path=/";
  }

  function getCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for (var i = 0; i < ca.length; i++) {
      var c = ca[i];
      while (c.charAt(0) === ' ') c = c.substring(1, c.length);
      if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
    }
    return null;
  }

  // Controlla se il consenso è già stato dato per nascondere il banner
  function checkConsent() {
    if (getCookie('consent_necessary') === "true") {
      document.getElementById('cookie-banner').style.display = 'none';
    } else {
      document.getElementById('cookie-banner').style.display = 'flex';
    }
  }

  // Funzione per accettare tutti i cookie
  window.acceptCookies = function() {
    setCookie('consent_necessary', 'true', 365);
    setCookie('consent_analytics', 'true', 365);
    setCookie('consent_marketing', 'true', 365);
    document.getElementById('cookie-banner').style.display = 'none';
    document.getElementById('cookie-popup').style.display = 'none';
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({event: 'cookie_consent', consent_analytics: true, consent_marketing: true});
  };

  // Funzione per rifiutare cookie opzionali (analytics e marketing)
  window.rejectCookies = function() {
    setCookie('consent_necessary', 'true', 365);
    setCookie('consent_analytics', 'false', 365);
    setCookie('consent_marketing', 'false', 365);
    document.getElementById('cookie-banner').style.display = 'none';
    document.getElementById('cookie-popup').style.display = 'none';
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({event: 'cookie_consent', consent_analytics: false, consent_marketing: false});
  };

  // Mostra il popup per gestire le preferenze dei cookie
  window.showCookiePopup = function(event) {
    event.preventDefault();
    document.getElementById('cookie-popup').style.display = 'flex';
  };
  window.closeCookiePopup = function() {
  document.getElementById('cookie-popup').style.display = 'none';
  };

  // Salva le preferenze impostate nel popup
  window.savePreferences = function() {
    var analyticsConsent = document.getElementById('analytics-cookies').checked;
    var marketingConsent = document.getElementById('marketing-cookies').checked;
    setCookie('consent_necessary', 'true', 365);
    setCookie('consent_analytics', analyticsConsent ? 'true' : 'false', 365);
    setCookie('consent_marketing', marketingConsent ? 'true' : 'false', 365);
    document.getElementById('cookie-banner').style.display = 'none';
    document.getElementById('cookie-popup').style.display = 'none';
    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({event: 'cookie_consent', consent_analytics: analyticsConsent, consent_marketing: marketingConsent});
  };

  // Inizializza il controllo del consenso al caricamento della pagina
  checkConsent();
})();</script></body></html>